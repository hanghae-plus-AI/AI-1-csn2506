{"metadata":{"colab":{"provenance":[{"file_id":"https://storage.googleapis.com/kaggle-colab-exported-notebooks/chapter3-1-huggingface-7b8dba73-daf0-4c32-929f-2cde6fc7c99e.ipynb?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com/20241008/auto/storage/goog4_request&X-Goog-Date=20241008T131418Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=538ae1e7b12b5fd3d0a8309d153d8a0bbddb069236b9ab9514c66ff7c444ae702d2e11db3eb19847a19d1310346ca14543cb72abf4a79901b425ccb7aff460fcc464c58233270285a1c4c2653e4c04a321c352f9dc64f612357b3b37232289ef8954fdbc8aa318d4baff6cc28fd9a54dac1e7b944443c3dd9d304cdf480ce69c59d33e134a27efeb5f380dd1acc035a1b5de3c7e9ca6dec0d878ab3590180dfd9faa606145e95276d6bed44ceeb9b324d20aa348672affd81a70a13067d716f615cd1db64ae9498d5b4c25aff0d442bddbacc8810bd0955aafa8fbb543d2961df090d3e1c732d9489466467ee51fa309d932fbc0be5b5c00e81c28192d454284","timestamp":1728393277698},{"file_id":"1iIhvEqckb-eDT5uhS92rnod2EVjSfj6K","timestamp":1728273345458}],"gpuType":"T4"},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"language_info":{"name":"python","version":"3.10.14","mimetype":"text/x-python","codemirror_mode":{"name":"ipython","version":3},"pygments_lexer":"ipython3","nbconvert_exporter":"python","file_extension":".py"},"widgets":{"application/vnd.jupyter.widget-state+json":{"e91973fff01e4de79db643c5525076e1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_59a056d5df6d491286aa5235722f4d18","IPY_MODEL_6c8f882924bb4bc588fc5d04e9e9fc1a","IPY_MODEL_2bb6c59355fc4063a525845ddc19e53d"],"layout":"IPY_MODEL_bbfa4bd11f69484e9fcbc5ea22106c5a"}},"59a056d5df6d491286aa5235722f4d18":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d858287fd83749859e6ae2d3663bd31c","placeholder":"​","style":"IPY_MODEL_a4216be25be9435aada949acb281bb48","value":"Downloading builder script: 100%"}},"6c8f882924bb4bc588fc5d04e9e9fc1a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3a70c200834e48a6bc2b4039eb511db9","max":4203,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cfcdb2eaeb66485f9a7056784339f02c","value":4203}},"2bb6c59355fc4063a525845ddc19e53d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_db47ac6e50d74d67ac7e5e44436439de","placeholder":"​","style":"IPY_MODEL_0da0a8a187794c469889deb71606919c","value":" 4.20k/4.20k [00:00&lt;00:00, 258kB/s]"}},"bbfa4bd11f69484e9fcbc5ea22106c5a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d858287fd83749859e6ae2d3663bd31c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a4216be25be9435aada949acb281bb48":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3a70c200834e48a6bc2b4039eb511db9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cfcdb2eaeb66485f9a7056784339f02c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"db47ac6e50d74d67ac7e5e44436439de":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0da0a8a187794c469889deb71606919c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c6142411ee78493aa65e15e1ce5201fe":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3178e5fb531e4cd183d8ccd6171bebf6","IPY_MODEL_fb6be0c4853c414184d7efb44fc2a6a7","IPY_MODEL_63941da3df744fe784061416bd2099b9"],"layout":"IPY_MODEL_c567919f2f4d465fbf058273664607e3"}},"3178e5fb531e4cd183d8ccd6171bebf6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ae00c046c53f4c3eabe6fa3c7964b76d","placeholder":"​","style":"IPY_MODEL_87a0d784813a496a84131c2930d735fe","value":"README.md: 100%"}},"fb6be0c4853c414184d7efb44fc2a6a7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8c1805dbfe284ce5a4aae284508a3096","max":8070,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1cba4338021341d5b7b58cc8661bf628","value":8070}},"63941da3df744fe784061416bd2099b9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8635c7b497184123ac6900ed5dc40170","placeholder":"​","style":"IPY_MODEL_22e33a9a7b344f6a886744e68798be7b","value":" 8.07k/8.07k [00:00&lt;00:00, 543kB/s]"}},"c567919f2f4d465fbf058273664607e3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ae00c046c53f4c3eabe6fa3c7964b76d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"87a0d784813a496a84131c2930d735fe":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8c1805dbfe284ce5a4aae284508a3096":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1cba4338021341d5b7b58cc8661bf628":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8635c7b497184123ac6900ed5dc40170":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"22e33a9a7b344f6a886744e68798be7b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0f09e67c6ced4a5d9ae8e0fdacb0c569":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3b3a0f00d0b0486080919deb6625bd61","IPY_MODEL_81b9695701fa4d4cbc067168eae67f4f","IPY_MODEL_b32ddbd063b84b71947caf81252bf6b5"],"layout":"IPY_MODEL_fea4d3d400574eca827be78299a2e032"}},"3b3a0f00d0b0486080919deb6625bd61":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bd00eeea70f94a02950e169a0ee2ad36","placeholder":"​","style":"IPY_MODEL_b010d7789819418aa71da761f96c666c","value":"train-00000-of-00001.parquet: 100%"}},"81b9695701fa4d4cbc067168eae67f4f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9ef934c248a54259a668f4a087b65716","max":18585438,"min":0,"orientation":"horizontal","style":"IPY_MODEL_18580d79df5042b387f53f817e8fde95","value":18585438}},"b32ddbd063b84b71947caf81252bf6b5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3c04a71877de4a90824f0941a3845153","placeholder":"​","style":"IPY_MODEL_07c83090d8c34fdbbe3c91202d3c64a2","value":" 18.6M/18.6M [00:00&lt;00:00, 37.2MB/s]"}},"fea4d3d400574eca827be78299a2e032":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bd00eeea70f94a02950e169a0ee2ad36":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b010d7789819418aa71da761f96c666c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9ef934c248a54259a668f4a087b65716":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18580d79df5042b387f53f817e8fde95":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3c04a71877de4a90824f0941a3845153":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"07c83090d8c34fdbbe3c91202d3c64a2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c5ebdcda25fe4bdaaa112c683186ab66":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8a05ac11b6fa4d5dbdac012ee9fedde5","IPY_MODEL_299ecf7204784ef1929328859b985a91","IPY_MODEL_887e1e247d204378b18bb9aa12ab433e"],"layout":"IPY_MODEL_5676e01c831c45fab8cc3322ce4006c3"}},"8a05ac11b6fa4d5dbdac012ee9fedde5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ca589c7b7259412483c1e9d241413213","placeholder":"​","style":"IPY_MODEL_4f27642bda6347bcb8fcfef91548c32c","value":"test-00000-of-00001.parquet: 100%"}},"299ecf7204784ef1929328859b985a91":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_dfe4860d0ac14834a6602098191ea0ea","max":1234829,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b2a03566c51b4f0d81f78f6a20fe45dc","value":1234829}},"887e1e247d204378b18bb9aa12ab433e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0906ec8aad9e46d09f9ecc89a6dd60f4","placeholder":"​","style":"IPY_MODEL_e4c301711ce54a928d6fbf58f63268cd","value":" 1.23M/1.23M [00:00&lt;00:00, 41.9MB/s]"}},"5676e01c831c45fab8cc3322ce4006c3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ca589c7b7259412483c1e9d241413213":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4f27642bda6347bcb8fcfef91548c32c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dfe4860d0ac14834a6602098191ea0ea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b2a03566c51b4f0d81f78f6a20fe45dc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0906ec8aad9e46d09f9ecc89a6dd60f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e4c301711ce54a928d6fbf58f63268cd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f74ef4d7100f40f8bd4d5eceb03c7460":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_23d710c9ce264ed28584e3c966f6fc0c","IPY_MODEL_27cb5610b5f444e0be39f290f8da9f9e","IPY_MODEL_12d4e449f8674f12a6b0cebb00c23b77"],"layout":"IPY_MODEL_a16b3e7843b4464f93b6d7928e3cdb9f"}},"23d710c9ce264ed28584e3c966f6fc0c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_24c9e37e64314470b64c07a6cb18b0e7","placeholder":"​","style":"IPY_MODEL_4a13d444786d4ca4b9db8e5e596655e6","value":"Generating train split: 100%"}},"27cb5610b5f444e0be39f290f8da9f9e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_093793a056944543941d2d62ded3cb29","max":120000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8270f2802464453ab7dc1fd226248927","value":120000}},"12d4e449f8674f12a6b0cebb00c23b77":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_905ead67b8ec4e948ee74669a0f341d6","placeholder":"​","style":"IPY_MODEL_7f152f2890af4078a6b6cbfb80e4fe69","value":" 120000/120000 [00:00&lt;00:00, 386334.29 examples/s]"}},"a16b3e7843b4464f93b6d7928e3cdb9f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"24c9e37e64314470b64c07a6cb18b0e7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4a13d444786d4ca4b9db8e5e596655e6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"093793a056944543941d2d62ded3cb29":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8270f2802464453ab7dc1fd226248927":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"905ead67b8ec4e948ee74669a0f341d6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7f152f2890af4078a6b6cbfb80e4fe69":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9fc4e0bfc86e40ac8dc582d9a1c5e440":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cc14f92acc5a4bb4988427922b36dfae","IPY_MODEL_3c75aeb7ae6941dd9f79478ab6bfb476","IPY_MODEL_278207dff26741b8822b34b8c9746d8b"],"layout":"IPY_MODEL_c7130437ac4b491da19b34141d217350"}},"cc14f92acc5a4bb4988427922b36dfae":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9799ebca9d194a65acee273241665f68","placeholder":"​","style":"IPY_MODEL_efea13e848984a8cb5d2cca83d15563f","value":"Generating test split: 100%"}},"3c75aeb7ae6941dd9f79478ab6bfb476":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c821febb7d3a459594a70e94409946d7","max":7600,"min":0,"orientation":"horizontal","style":"IPY_MODEL_92a348878d574c1f88104dec9cb4f937","value":7600}},"278207dff26741b8822b34b8c9746d8b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b540bfcc2ac3476aaa76df176944cb02","placeholder":"​","style":"IPY_MODEL_004aacc1460a42faa0c98501a942503b","value":" 7600/7600 [00:00&lt;00:00, 148042.05 examples/s]"}},"c7130437ac4b491da19b34141d217350":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9799ebca9d194a65acee273241665f68":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"efea13e848984a8cb5d2cca83d15563f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c821febb7d3a459594a70e94409946d7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"92a348878d574c1f88104dec9cb4f937":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b540bfcc2ac3476aaa76df176944cb02":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"004aacc1460a42faa0c98501a942503b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"63b3068ddea747a8aad4d40229227f78":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cc79df657ae342189a40728c1816facf","IPY_MODEL_9dd253cb8f3e4782af0061dc2ec64aff","IPY_MODEL_1a90012641fc41908bdbed7ab590e18e"],"layout":"IPY_MODEL_f90fc6f4394a462f8165c1858164273a"}},"cc79df657ae342189a40728c1816facf":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b855c7c3fd584039a2528825d7f4083a","placeholder":"​","style":"IPY_MODEL_f7211a166d2f4b94add943ddd78cfa66","value":"Map: 100%"}},"9dd253cb8f3e4782af0061dc2ec64aff":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_bebd9aa6f4eb411bb91ec5857217b01a","max":7600,"min":0,"orientation":"horizontal","style":"IPY_MODEL_48b8688cfea449c89df57e54b4c7de37","value":7600}},"1a90012641fc41908bdbed7ab590e18e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_265b5610c2424cbda25a3d30e6f9b6db","placeholder":"​","style":"IPY_MODEL_4580c4b2516f406a9b18ca832f4bf67f","value":" 7600/7600 [00:04&lt;00:00, 2083.45 examples/s]"}},"f90fc6f4394a462f8165c1858164273a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b855c7c3fd584039a2528825d7f4083a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f7211a166d2f4b94add943ddd78cfa66":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bebd9aa6f4eb411bb91ec5857217b01a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"48b8688cfea449c89df57e54b4c7de37":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"265b5610c2424cbda25a3d30e6f9b6db":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4580c4b2516f406a9b18ca832f4bf67f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}},"accelerator":"GPU","kaggle":{"accelerator":"gpu","dataSources":[],"isInternetEnabled":true,"language":"python","sourceType":"notebook","isGpuEnabled":true}},"nbformat_minor":0,"nbformat":4,"cells":[{"cell_type":"markdown","source":["\n","# HuggingFace로 두 문장의 논리적 모순 분류하기\n","\n","## 목표\n","\n","---\n","\n","이번 과제는 자연어 task 중 하나인 MNLI를 해결하는 모델을 HuggingFace로 학습하는 것입니다. MNLI를 요약하면 다음과 같습니다.\n","\n","- **입력**: premise에 해당하는 문장과 hypothesis에 해당하는 문장 두 개가 입력으로 들어옵니다.\n","- **출력:** 분류 문제로, 두 문장이 들어왔을 때 다음 세 가지를 예측하시면 됩니다.\n","    - **Entailment:** 두 문장에 논리적 모순이 없습니다.\n","    - **Neutral:** 두 문장은 논리적으로 관련이 없습니다.\n","    - **Contradiction:** 두 문장 사이에 논리적 모순이 존재합니다."],"metadata":{"id":"owTOpkIFX3wb"}},{"cell_type":"code","source":["!pip install transformers datasets evaluate accelerate scikit-learn"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UeHRwq3aR-bc","executionInfo":{"status":"ok","timestamp":1728273665675,"user_tz":-540,"elapsed":13554,"user":{"displayName":"조성남","userId":"10831514774218419222"}},"outputId":"1caae655-1656-4036-d46d-1312f644347d","execution":{"iopub.status.busy":"2024-10-08T11:56:12.392814Z","iopub.execute_input":"2024-10-08T11:56:12.393394Z","iopub.status.idle":"2024-10-08T11:56:25.872003Z","shell.execute_reply.started":"2024-10-08T11:56:12.393358Z","shell.execute_reply":"2024-10-08T11:56:25.870836Z"},"trusted":true},"execution_count":null,"outputs":[{"name":"stdout","text":"Requirement already satisfied: transformers in /opt/conda/lib/python3.10/site-packages (4.45.1)\nRequirement already satisfied: datasets in /opt/conda/lib/python3.10/site-packages (3.0.1)\nCollecting evaluate\n  Downloading evaluate-0.4.3-py3-none-any.whl.metadata (9.2 kB)\nRequirement already satisfied: accelerate in /opt/conda/lib/python3.10/site-packages (0.34.2)\nRequirement already satisfied: scikit-learn in /opt/conda/lib/python3.10/site-packages (1.2.2)\nRequirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from transformers) (3.15.1)\nRequirement already satisfied: huggingface-hub<1.0,>=0.23.2 in /opt/conda/lib/python3.10/site-packages (from transformers) (0.25.1)\nRequirement already satisfied: numpy>=1.17 in /opt/conda/lib/python3.10/site-packages (from transformers) (1.26.4)\nRequirement already satisfied: packaging>=20.0 in /opt/conda/lib/python3.10/site-packages (from transformers) (21.3)\nRequirement already satisfied: pyyaml>=5.1 in /opt/conda/lib/python3.10/site-packages (from transformers) (6.0.2)\nRequirement already satisfied: regex!=2019.12.17 in /opt/conda/lib/python3.10/site-packages (from transformers) (2024.5.15)\nRequirement already satisfied: requests in /opt/conda/lib/python3.10/site-packages (from transformers) (2.32.3)\nRequirement already satisfied: safetensors>=0.4.1 in /opt/conda/lib/python3.10/site-packages (from transformers) (0.4.5)\nRequirement already satisfied: tokenizers<0.21,>=0.20 in /opt/conda/lib/python3.10/site-packages (from transformers) (0.20.0)\nRequirement already satisfied: tqdm>=4.27 in /opt/conda/lib/python3.10/site-packages (from transformers) (4.66.4)\nRequirement already satisfied: pyarrow>=15.0.0 in /opt/conda/lib/python3.10/site-packages (from datasets) (16.1.0)\nRequirement already satisfied: dill<0.3.9,>=0.3.0 in /opt/conda/lib/python3.10/site-packages (from datasets) (0.3.8)\nRequirement already satisfied: pandas in /opt/conda/lib/python3.10/site-packages (from datasets) (2.2.2)\nRequirement already satisfied: xxhash in /opt/conda/lib/python3.10/site-packages (from datasets) (3.4.1)\nRequirement already satisfied: multiprocess in /opt/conda/lib/python3.10/site-packages (from datasets) (0.70.16)\nRequirement already satisfied: fsspec<=2024.6.1,>=2023.1.0 in /opt/conda/lib/python3.10/site-packages (from fsspec[http]<=2024.6.1,>=2023.1.0->datasets) (2024.6.1)\nRequirement already satisfied: aiohttp in /opt/conda/lib/python3.10/site-packages (from datasets) (3.9.5)\nRequirement already satisfied: psutil in /opt/conda/lib/python3.10/site-packages (from accelerate) (5.9.3)\nRequirement already satisfied: torch>=1.10.0 in /opt/conda/lib/python3.10/site-packages (from accelerate) (2.4.0)\nRequirement already satisfied: scipy>=1.3.2 in /opt/conda/lib/python3.10/site-packages (from scikit-learn) (1.14.1)\nRequirement already satisfied: joblib>=1.1.1 in /opt/conda/lib/python3.10/site-packages (from scikit-learn) (1.4.2)\nRequirement already satisfied: threadpoolctl>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from scikit-learn) (3.5.0)\nRequirement already satisfied: aiosignal>=1.1.2 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets) (1.3.1)\nRequirement already satisfied: attrs>=17.3.0 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets) (23.2.0)\nRequirement already satisfied: frozenlist>=1.1.1 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets) (1.4.1)\nRequirement already satisfied: multidict<7.0,>=4.5 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets) (6.0.5)\nRequirement already satisfied: yarl<2.0,>=1.0 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets) (1.9.4)\nRequirement already satisfied: async-timeout<5.0,>=4.0 in /opt/conda/lib/python3.10/site-packages (from aiohttp->datasets) (4.0.3)\nRequirement already satisfied: typing-extensions>=3.7.4.3 in /opt/conda/lib/python3.10/site-packages (from huggingface-hub<1.0,>=0.23.2->transformers) (4.12.2)\nRequirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /opt/conda/lib/python3.10/site-packages (from packaging>=20.0->transformers) (3.1.2)\nRequirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests->transformers) (3.3.2)\nRequirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests->transformers) (3.7)\nRequirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests->transformers) (1.26.18)\nRequirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests->transformers) (2024.8.30)\nRequirement already satisfied: sympy in /opt/conda/lib/python3.10/site-packages (from torch>=1.10.0->accelerate) (1.13.3)\nRequirement already satisfied: networkx in /opt/conda/lib/python3.10/site-packages (from torch>=1.10.0->accelerate) (3.3)\nRequirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from torch>=1.10.0->accelerate) (3.1.4)\nRequirement already satisfied: python-dateutil>=2.8.2 in /opt/conda/lib/python3.10/site-packages (from pandas->datasets) (2.9.0.post0)\nRequirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas->datasets) (2024.1)\nRequirement already satisfied: tzdata>=2022.7 in /opt/conda/lib/python3.10/site-packages (from pandas->datasets) (2024.1)\nRequirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.16.0)\nRequirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->torch>=1.10.0->accelerate) (2.1.5)\nRequirement already satisfied: mpmath<1.4,>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from sympy->torch>=1.10.0->accelerate) (1.3.0)\nDownloading evaluate-0.4.3-py3-none-any.whl (84 kB)\n\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m84.0/84.0 kB\u001b[0m \u001b[31m2.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hInstalling collected packages: evaluate\nSuccessfully installed evaluate-0.4.3\n","output_type":"stream"}]},{"cell_type":"code","source":["import random\n","import evaluate\n","import numpy as np\n","\n","from datasets import load_dataset\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification"],"metadata":{"id":"QObF2OAzYwLi","execution":{"iopub.status.busy":"2024-10-08T11:56:25.874193Z","iopub.execute_input":"2024-10-08T11:56:25.874545Z","iopub.status.idle":"2024-10-08T11:56:44.880228Z","shell.execute_reply.started":"2024-10-08T11:56:25.874508Z","shell.execute_reply":"2024-10-08T11:56:44.87936Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## Dataset 준비\n","\n","- `load_dataset(\"nyu-mll/glue\", \"mnli\")` 로 dataset을 불러옵니다.\n","    - 학습 때는 `train` split만 활용하셔야 합니다. 나머지 split은 사용불가입니다.\n","    - Validation data가 필요한 경우, `train` split에서 가져오셔야 합니다."],"metadata":{"id":"7vOSyAKGim9f"}},{"cell_type":"code","source":["dataset = load_dataset(\"nyu-mll/glue\", \"mnli\")# 데이터셋 변경\n","dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":491,"referenced_widgets":["c6142411ee78493aa65e15e1ce5201fe","3178e5fb531e4cd183d8ccd6171bebf6","fb6be0c4853c414184d7efb44fc2a6a7","63941da3df744fe784061416bd2099b9","c567919f2f4d465fbf058273664607e3","ae00c046c53f4c3eabe6fa3c7964b76d","87a0d784813a496a84131c2930d735fe","8c1805dbfe284ce5a4aae284508a3096","1cba4338021341d5b7b58cc8661bf628","8635c7b497184123ac6900ed5dc40170","22e33a9a7b344f6a886744e68798be7b","0f09e67c6ced4a5d9ae8e0fdacb0c569","3b3a0f00d0b0486080919deb6625bd61","81b9695701fa4d4cbc067168eae67f4f","b32ddbd063b84b71947caf81252bf6b5","fea4d3d400574eca827be78299a2e032","bd00eeea70f94a02950e169a0ee2ad36","b010d7789819418aa71da761f96c666c","9ef934c248a54259a668f4a087b65716","18580d79df5042b387f53f817e8fde95","3c04a71877de4a90824f0941a3845153","07c83090d8c34fdbbe3c91202d3c64a2","c5ebdcda25fe4bdaaa112c683186ab66","8a05ac11b6fa4d5dbdac012ee9fedde5","299ecf7204784ef1929328859b985a91","887e1e247d204378b18bb9aa12ab433e","5676e01c831c45fab8cc3322ce4006c3","ca589c7b7259412483c1e9d241413213","4f27642bda6347bcb8fcfef91548c32c","dfe4860d0ac14834a6602098191ea0ea","b2a03566c51b4f0d81f78f6a20fe45dc","0906ec8aad9e46d09f9ecc89a6dd60f4","e4c301711ce54a928d6fbf58f63268cd","f74ef4d7100f40f8bd4d5eceb03c7460","23d710c9ce264ed28584e3c966f6fc0c","27cb5610b5f444e0be39f290f8da9f9e","12d4e449f8674f12a6b0cebb00c23b77","a16b3e7843b4464f93b6d7928e3cdb9f","24c9e37e64314470b64c07a6cb18b0e7","4a13d444786d4ca4b9db8e5e596655e6","093793a056944543941d2d62ded3cb29","8270f2802464453ab7dc1fd226248927","905ead67b8ec4e948ee74669a0f341d6","7f152f2890af4078a6b6cbfb80e4fe69","9fc4e0bfc86e40ac8dc582d9a1c5e440","cc14f92acc5a4bb4988427922b36dfae","3c75aeb7ae6941dd9f79478ab6bfb476","278207dff26741b8822b34b8c9746d8b","c7130437ac4b491da19b34141d217350","9799ebca9d194a65acee273241665f68","efea13e848984a8cb5d2cca83d15563f","c821febb7d3a459594a70e94409946d7","92a348878d574c1f88104dec9cb4f937","b540bfcc2ac3476aaa76df176944cb02","004aacc1460a42faa0c98501a942503b","25e37291584140dfb6d6d3b3d2ecb271","e55234de36aa4a1fb5513bcdef203123","6e1767719f804cc9a642322b3faa4ba2","41d27fbfa07b47e0951e389ed69e1160","6b132fb376ad4777bb65f7f3ee814c29","fdd0a95bd45f481fb9891b445868de3b","db8f8171c45147da9884c71251af53f8","a699034e2a9144c6b857f6affb60df73","b3e660c070b84b03b8b2aef08c5ea723","eedef73b834d4d75a9549f7cc86470bd","aeba189947a44163b71a831de8af805e"]},"id":"HzxfcmYPZA7x","executionInfo":{"status":"ok","timestamp":1728273717371,"user_tz":-540,"elapsed":5019,"user":{"displayName":"조성남","userId":"10831514774218419222"}},"outputId":"34df313e-4ec0-4db7-84e0-20225150a456","execution":{"iopub.status.busy":"2024-10-08T11:56:44.881421Z","iopub.execute_input":"2024-10-08T11:56:44.882011Z","iopub.status.idle":"2024-10-08T11:56:49.712255Z","shell.execute_reply.started":"2024-10-08T11:56:44.881975Z","shell.execute_reply":"2024-10-08T11:56:49.711187Z"},"trusted":true},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":"README.md:   0%|          | 0.00/35.3k [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"25e37291584140dfb6d6d3b3d2ecb271"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"train-00000-of-00001.parquet:   0%|          | 0.00/52.2M [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e55234de36aa4a1fb5513bcdef203123"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"(…)alidation_matched-00000-of-00001.parquet:   0%|          | 0.00/1.21M [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6e1767719f804cc9a642322b3faa4ba2"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"(…)dation_mismatched-00000-of-00001.parquet:   0%|          | 0.00/1.25M [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"41d27fbfa07b47e0951e389ed69e1160"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"test_matched-00000-of-00001.parquet:   0%|          | 0.00/1.22M [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6b132fb376ad4777bb65f7f3ee814c29"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"test_mismatched-00000-of-00001.parquet:   0%|          | 0.00/1.26M [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"fdd0a95bd45f481fb9891b445868de3b"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"Generating train split:   0%|          | 0/392702 [00:00<?, ? examples/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"db8f8171c45147da9884c71251af53f8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"Generating validation_matched split:   0%|          | 0/9815 [00:00<?, ? examples/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a699034e2a9144c6b857f6affb60df73"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"Generating validation_mismatched split:   0%|          | 0/9832 [00:00<?, ? examples/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b3e660c070b84b03b8b2aef08c5ea723"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"Generating test_matched split:   0%|          | 0/9796 [00:00<?, ? examples/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"eedef73b834d4d75a9549f7cc86470bd"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"Generating test_mismatched split:   0%|          | 0/9847 [00:00<?, ? examples/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"aeba189947a44163b71a831de8af805e"}},"metadata":{}},{"execution_count":3,"output_type":"execute_result","data":{"text/plain":"DatasetDict({\n    train: Dataset({\n        features: ['premise', 'hypothesis', 'label', 'idx'],\n        num_rows: 392702\n    })\n    validation_matched: Dataset({\n        features: ['premise', 'hypothesis', 'label', 'idx'],\n        num_rows: 9815\n    })\n    validation_mismatched: Dataset({\n        features: ['premise', 'hypothesis', 'label', 'idx'],\n        num_rows: 9832\n    })\n    test_matched: Dataset({\n        features: ['premise', 'hypothesis', 'label', 'idx'],\n        num_rows: 9796\n    })\n    test_mismatched: Dataset({\n        features: ['premise', 'hypothesis', 'label', 'idx'],\n        num_rows: 9847\n    })\n})"},"metadata":{}}]},{"cell_type":"markdown","source":["`load_dataset`은 HuggingFace의 `datasets` library의 함수로, HuggingFace의 hub에서 dataset을 다운로드 받을 수 있도록 만든 함수입니다.\n","출력 결과를 보시면 `train_data`는 `train`, `test` data로 구성되어있습니다.\n","이 중에서 우리는 `train`과 `test`를 활용합니다.\n","\n","`train` data를 한 번 살펴보겠습니다."],"metadata":{"id":"BT1VSMq-iuRl"}},{"cell_type":"code","source":["train_data = dataset['train']# 학습 데이터만 사용\n","train_data"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9nVFOdAIi4Hj","executionInfo":{"status":"ok","timestamp":1728273738795,"user_tz":-540,"elapsed":336,"user":{"displayName":"조성남","userId":"10831514774218419222"}},"outputId":"0736426e-6a3a-4b62-8f67-a14a2335e5d2","execution":{"iopub.status.busy":"2024-10-08T11:56:49.714364Z","iopub.execute_input":"2024-10-08T11:56:49.714744Z","iopub.status.idle":"2024-10-08T11:56:49.722687Z","shell.execute_reply.started":"2024-10-08T11:56:49.714711Z","shell.execute_reply":"2024-10-08T11:56:49.721868Z"},"trusted":true},"execution_count":null,"outputs":[{"execution_count":4,"output_type":"execute_result","data":{"text/plain":"Dataset({\n    features: ['premise', 'hypothesis', 'label', 'idx'],\n    num_rows: 392702\n})"},"metadata":{}}]},{"cell_type":"markdown","source":["이번에는 tokenizer를 불러와서 미리 text들을 tokenize합니다."],"metadata":{"id":"6YdYEPD6nXzx"}},{"cell_type":"code","source":["tokenizer = AutoTokenizer.from_pretrained(\"bert-base-cased\")\n","\n","def preprocess_function(data):\n","    return tokenizer(data[\"premise\"], data[\"hypothesis\"], truncation=True, padding=\"max_length\")\n","\n","\n","train_data_split = train_data.train_test_split(test_size=0.2)\n","\n","train_data_tokenized = train_data_split.map(preprocess_function, batched=True)\n","\n","train_data_train, train_data_val = train_data_tokenized['train'], train_data_tokenized['test']\n","\n"],"metadata":{"id":"BhC_ETFZZRJ2","colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["63b3068ddea747a8aad4d40229227f78","cc79df657ae342189a40728c1816facf","9dd253cb8f3e4782af0061dc2ec64aff","1a90012641fc41908bdbed7ab590e18e","f90fc6f4394a462f8165c1858164273a","b855c7c3fd584039a2528825d7f4083a","f7211a166d2f4b94add943ddd78cfa66","bebd9aa6f4eb411bb91ec5857217b01a","48b8688cfea449c89df57e54b4c7de37","265b5610c2424cbda25a3d30e6f9b6db","4580c4b2516f406a9b18ca832f4bf67f","a3573480de4645f8aa8370cf2d6194db","9b77a578dd9249af87e8fa15faccf0a5","8fb30f80b42c4759a1cd7249cc4d077c","f7662a1ad31b4255beeae7aa91b5fa39","7c210422035f42c088dc10264228e456","2d87b3935adb46f588b62fbec83a2574"]},"executionInfo":{"status":"ok","timestamp":1728273938775,"user_tz":-540,"elapsed":4488,"user":{"displayName":"조성남","userId":"10831514774218419222"}},"outputId":"7c3520ba-8f8b-4368-ac7d-2cfb4ba64da3","execution":{"iopub.status.busy":"2024-10-08T11:56:49.723888Z","iopub.execute_input":"2024-10-08T11:56:49.724525Z","iopub.status.idle":"2024-10-08T11:59:49.216908Z","shell.execute_reply.started":"2024-10-08T11:56:49.72449Z","shell.execute_reply":"2024-10-08T11:59:49.215948Z"},"trusted":true},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":"tokenizer_config.json:   0%|          | 0.00/49.0 [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a3573480de4645f8aa8370cf2d6194db"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"config.json:   0%|          | 0.00/570 [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"9b77a578dd9249af87e8fa15faccf0a5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"vocab.txt:   0%|          | 0.00/213k [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8fb30f80b42c4759a1cd7249cc4d077c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"tokenizer.json:   0%|          | 0.00/436k [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f7662a1ad31b4255beeae7aa91b5fa39"}},"metadata":{}},{"name":"stderr","text":"/opt/conda/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1617: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be deprecated in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884\n  warnings.warn(\n","output_type":"stream"},{"output_type":"display_data","data":{"text/plain":"Map:   0%|          | 0/314161 [00:00<?, ? examples/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7c210422035f42c088dc10264228e456"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"Map:   0%|          | 0/78541 [00:00<?, ? examples/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2d87b3935adb46f588b62fbec83a2574"}},"metadata":{}}]},{"cell_type":"markdown","source":["Tokenizer를 실행할 때 넘겨주었던 `truncation` 옵션은 주어진 text가 일정 길이 이상이면 잘라내라는 의미입니다.\n","만약 특정 길이 값이 같이 주어지지 않는다면 `bert-base-cased`를 학습할 때 사용한 text의 최대 길이를 기준으로 값을 결정합니다."],"metadata":{"id":"ba2jcRcLpjc1"}},{"cell_type":"markdown","source":["마지막 출력 결과를 보면, `text`와 `label` 이외에 `input_ids`가 생기신 것을 확인하실 수 있습니다.\n","이는 우리가 `AutoTokenizer.from_pretrained`로 불러온 tokenizer로 text를 token들로 나누고 정수 index로 변환한 결과입니다.\n","\n","이번에는 `train` data를 쪼개 training data와 validation data를 만들어보겠습니다."],"metadata":{"id":"Wfq0Ih4hqXYC"}},{"cell_type":"markdown","source":["HuggingFace `datasets`로 불러온 dataset은 `train_test_split`으로 쉽게 쪼갤 수 있습니다.\n","\n","다음은 각 split의 크기입니다."],"metadata":{"id":"BS1FltWfqjnz"}},{"cell_type":"code","source":["len(train_data_train), len(train_data_val)\n","\n","print(train_data_train.column_names)\n","print(train_data_val.column_names)\n","# print(tokenized_eval_dataset.column_names)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5SGfOwadaYlk","executionInfo":{"status":"ok","timestamp":1728274193426,"user_tz":-540,"elapsed":319,"user":{"displayName":"조성남","userId":"10831514774218419222"}},"outputId":"9e08f3a7-91b2-4e62-bf33-b9f4c11b7518","execution":{"iopub.status.busy":"2024-10-08T11:59:49.219853Z","iopub.execute_input":"2024-10-08T11:59:49.220184Z","iopub.status.idle":"2024-10-08T11:59:49.225247Z","shell.execute_reply.started":"2024-10-08T11:59:49.220148Z","shell.execute_reply":"2024-10-08T11:59:49.224159Z"},"trusted":true},"execution_count":null,"outputs":[{"name":"stdout","text":"['premise', 'hypothesis', 'label', 'idx', 'input_ids', 'token_type_ids', 'attention_mask']\n['premise', 'hypothesis', 'label', 'idx', 'input_ids', 'token_type_ids', 'attention_mask']\n","output_type":"stream"}]},{"cell_type":"markdown","source":["## Model 구현\n","\n","이번에는 text 분류를 수행할 Transformer를 구현합니다.\n","이전에는 Transformer의 구성 요소들을 직접 구현하여 합쳤습니다.\n","이번에는 HuggingFace의 BERT를 활용하여 인자만 넘겨주는 식으로 구현해보겠습니다:"],"metadata":{"id":"cGe7Fa9wqrCC"}},{"cell_type":"code","source":["from transformers import BertConfig\n","\n","config = BertConfig()\n","\n","config.hidden_size = 64  # BERT layer의 기본 hidden dimension\n","config.intermediate_size = 64  # FFN layer의 중간 hidden dimension\n","config.num_hidden_layers = 2  # BERT layer의 개수\n","config.num_attention_heads = 4  # Multi-head attention에서 사용하는 head 개수\n","config.num_labels = 3  # 마지막에 예측해야 하는 분류 문제의 class 개수\n","\n","model = AutoModelForSequenceClassification.from_config(config)"],"metadata":{"id":"xw-ZdYVCZfxU","execution":{"iopub.status.busy":"2024-10-08T11:59:49.226573Z","iopub.execute_input":"2024-10-08T11:59:49.226946Z","iopub.status.idle":"2024-10-08T11:59:49.501783Z","shell.execute_reply.started":"2024-10-08T11:59:49.226901Z","shell.execute_reply":"2024-10-08T11:59:49.501052Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["BERT는 이전에 배운 Transformer의 architecture를 그대로 사용합니다.\n","그래서 BERT의 옵션들만 수정하면 vanilla Transformer를 쉽게 구현할 수 있습니다.\n","\n","Transformer 구현 이외에 분류 문제에 맞춰 첫 번째 token을 linear classifier를 거치는 등의 과정은 `AutoModelForSequenceClassification`이 구현해줍니다.\n","즉, 우리가 `config`로 넘겨주는 BERT의 마지막에 linear classifier를 달아주는 역할을 합니다."],"metadata":{"id":"BQpVs-lirLp5"}},{"cell_type":"markdown","source":["## 학습 코드\n","\n","다음은 위에서 구현한 Transformer를 train_data로 학습하는 코드를 구현합니다.\n","먼저 다음과 같이 학습 인자들을 정의합니다."],"metadata":{"id":"31PYtx_Vrj1Y"}},{"cell_type":"code","source":["from transformers import TrainingArguments, Trainer\n","\n","training_args = TrainingArguments(\n","    output_dir='hf_transformer_mnli',  # 모델, log 등을 저장할 directory\n","#     report_to=\"none\",\n","    num_train_epochs=5,  # epoch 수\n","    per_device_train_batch_size=128,  # training data의 batch size\n","    per_device_eval_batch_size=128,  # validation data의 batch size\n","    logging_strategy=\"epoch\",  # Epoch가 끝날 때마다 training loss 등을 log하라는 의미\n","    do_train=True,  # 학습을 진행하겠다는 의미\n","    do_eval=True,  # 학습 중간에 validation data에 대한 평가를 수행하겠다는 의미\n","    eval_strategy=\"epoch\",  # 매 epoch가 끝날 때마다 validation data에 대한 평가를 수행한다는 의미\n","    save_strategy=\"epoch\",  # 매 epoch가 끝날 때마다 모델을 저장하겠다는 의미\n","    learning_rate=1e-3,  # optimizer에 사용할 learning rate\n","    load_best_model_at_end=True  # 학습이 끝난 후, validation data에 대한 성능이 가장 좋은 모델을 채택하겠다는 의미\n",")"],"metadata":{"id":"YtqLwO7sZhXT","execution":{"iopub.status.busy":"2024-10-08T11:59:49.502858Z","iopub.execute_input":"2024-10-08T11:59:49.503174Z","iopub.status.idle":"2024-10-08T11:59:50.695708Z","shell.execute_reply.started":"2024-10-08T11:59:49.503142Z","shell.execute_reply":"2024-10-08T11:59:50.694743Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["각각의 부분들은 이전 주차에서 배웠던 내용들을 설정하는 것에 불과하다는 것을 알 수 있습니다.\n","요약하면 다음과 같습니다:\n","- `epochs`: training data를 몇 번 반복할 것인지 결정합니다.\n","- `batch_size`: training data를 얼마나 잘게 잘라서 학습할 것인지 결정합니다.\n","- `learning_rate`: optimizer의 learning rate를 얼마로 할 것인지 결정합니다.\n","위의 부분들 이외에도 사소한 구현 요소들도 지정할 수 있습니다.\n","\n","다음은 loss 이외의 평가 함수들을 구현하는 방법입니다."],"metadata":{"id":"rKvB31IlsK2f"}},{"cell_type":"code","source":["import evaluate\n","\n","accuracy = evaluate.load(\"accuracy\")\n","\n","\n","def compute_metrics(pred):\n","    predictions, labels = pred\n","    predictions = np.argmax(predictions, axis=-1)\n","    return accuracy.compute(predictions=predictions, references=labels)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["e91973fff01e4de79db643c5525076e1","59a056d5df6d491286aa5235722f4d18","6c8f882924bb4bc588fc5d04e9e9fc1a","2bb6c59355fc4063a525845ddc19e53d","bbfa4bd11f69484e9fcbc5ea22106c5a","d858287fd83749859e6ae2d3663bd31c","a4216be25be9435aada949acb281bb48","3a70c200834e48a6bc2b4039eb511db9","cfcdb2eaeb66485f9a7056784339f02c","db47ac6e50d74d67ac7e5e44436439de","0da0a8a187794c469889deb71606919c","649b5e8c169445b7bff8222e7e3e2645"]},"id":"Wa2zYLTUZ8rD","executionInfo":{"status":"ok","timestamp":1725798823141,"user_tz":-540,"elapsed":722,"user":{"displayName":"조승혁","userId":"15759752471844115325"}},"outputId":"843aba34-6f18-42e5-d732-6e2ff658a69e","execution":{"iopub.status.busy":"2024-10-08T11:59:50.697192Z","iopub.execute_input":"2024-10-08T11:59:50.697503Z","iopub.status.idle":"2024-10-08T11:59:51.356227Z","shell.execute_reply.started":"2024-10-08T11:59:50.69747Z","shell.execute_reply":"2024-10-08T11:59:51.355334Z"},"trusted":true},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":"Downloading builder script:   0%|          | 0.00/4.20k [00:00<?, ?B/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"649b5e8c169445b7bff8222e7e3e2645"}},"metadata":{}}]},{"cell_type":"markdown","source":["`evaluate` 또한 HuggingFace의 library로 다양한 평가 함수들을 제공하고 있습니다.\n","이번 실습의 경우, 감정 분석 문제는 분류 문제이기 때문에 정확도를 계산할 수 있습니다.\n","위와 같이 예측 결과(`pred`)와 실제 label(`labels`)가 주어졌을 때 정확도를 계산하는 것은 `evaluate`의 accuracy 함수로 구현할 수 있습니다.\n","\n","마지막으로 위의 요소들을 종합하여 학습할 수 있는 `Trainer`를 구현합니다."],"metadata":{"id":"tGENAMKk-4I2"}},{"cell_type":"code","source":["from transformers import EarlyStoppingCallback\n","\n","\n","trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=train_data_train,\n","    eval_dataset=train_data_val,\n","    compute_metrics=compute_metrics,\n","    tokenizer=tokenizer,\n","    # callbacks = [EarlyStoppingCallback(early_stopping_patience=1)]\n",")"],"metadata":{"id":"Ci4lNfK6Z_z4","execution":{"iopub.status.busy":"2024-10-08T11:59:51.359409Z","iopub.execute_input":"2024-10-08T11:59:51.359698Z","iopub.status.idle":"2024-10-08T11:59:52.293919Z","shell.execute_reply.started":"2024-10-08T11:59:51.359668Z","shell.execute_reply":"2024-10-08T11:59:52.293159Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["모델, training 인자, training과 validation data, 부가적인 평가 함수, 그리고 tokenizer를 넘겨주면 끝입니다.\n","별개로 early stopping과 같은 기능도 주석 친 부분과 같이 `callbacks`로 구현할 수 있으니 참고해주시길 바랍니다.\n","\n","위와 같이 만든 `Trainer`는 다음과 같이 학습을 할 수 있습니다."],"metadata":{"id":"MOK4poi1_Mgh"}},{"cell_type":"code","source":["trainer.train() # 모델 학습"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":408,"referenced_widgets":["4d187b7b983446cfb8b6abd16669d89c"]},"id":"qmNkWuVVaBEc","executionInfo":{"status":"ok","timestamp":1725797895052,"user_tz":-540,"elapsed":395226,"user":{"displayName":"조승혁","userId":"15759752471844115325"}},"outputId":"7a610572-458b-4577-f838-3d2488268616","execution":{"iopub.status.busy":"2024-10-08T11:59:52.294883Z","iopub.execute_input":"2024-10-08T11:59:52.295182Z","iopub.status.idle":"2024-10-08T13:08:12.165612Z","shell.execute_reply.started":"2024-10-08T11:59:52.295144Z","shell.execute_reply":"2024-10-08T13:08:12.164739Z"},"trusted":true},"execution_count":null,"outputs":[{"name":"stderr","text":"\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.\n\u001b[34m\u001b[1mwandb\u001b[0m: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.\n\u001b[34m\u001b[1mwandb\u001b[0m: Logging into wandb.ai. (Learn how to deploy a W&B server locally: https://wandb.me/wandb-server)\n\u001b[34m\u001b[1mwandb\u001b[0m: You can find your API key in your browser here: https://wandb.ai/authorize\n\u001b[34m\u001b[1mwandb\u001b[0m: Paste an API key from your profile and hit enter, or press ctrl+c to quit:","output_type":"stream"},{"output_type":"stream","name":"stdin","text":"  ········································\n"},{"name":"stderr","text":"\u001b[34m\u001b[1mwandb\u001b[0m: Appending key for api.wandb.ai to your netrc file: /root/.netrc\n","output_type":"stream"},{"output_type":"display_data","data":{"text/plain":"VBox(children=(Label(value='Waiting for wandb.init()...\\r'), FloatProgress(value=0.011112694100000277, max=1.0…","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"4d187b7b983446cfb8b6abd16669d89c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"<IPython.core.display.HTML object>","text/html":"Tracking run with wandb version 0.18.3"},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"<IPython.core.display.HTML object>","text/html":"Run data is saved locally in <code>/kaggle/working/wandb/run-20241008_120003-rz6wy4kc</code>"},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"<IPython.core.display.HTML object>","text/html":"Syncing run <strong><a href='https://wandb.ai/csn2506-diem/huggingface/runs/rz6wy4kc' target=\"_blank\">hf_transformer_mnli</a></strong> to <a href='https://wandb.ai/csn2506-diem/huggingface' target=\"_blank\">Weights & Biases</a> (<a href='https://wandb.me/run' target=\"_blank\">docs</a>)<br/>"},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"<IPython.core.display.HTML object>","text/html":" View project at <a href='https://wandb.ai/csn2506-diem/huggingface' target=\"_blank\">https://wandb.ai/csn2506-diem/huggingface</a>"},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"<IPython.core.display.HTML object>","text/html":" View run at <a href='https://wandb.ai/csn2506-diem/huggingface/runs/rz6wy4kc' target=\"_blank\">https://wandb.ai/csn2506-diem/huggingface/runs/rz6wy4kc</a>"},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"<IPython.core.display.HTML object>","text/html":"\n    <div>\n      \n      <progress value='12275' max='12275' style='width:300px; height:20px; vertical-align: middle;'></progress>\n      [12275/12275 1:08:04, Epoch 5/5]\n    </div>\n    <table border=\"1\" class=\"dataframe\">\n  <thead>\n <tr style=\"text-align: left;\">\n      <th>Epoch</th>\n      <th>Training Loss</th>\n      <th>Validation Loss</th>\n      <th>Accuracy</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>1</td>\n      <td>0.967700</td>\n      <td>0.897676</td>\n      <td>0.581034</td>\n    </tr>\n    <tr>\n      <td>2</td>\n      <td>0.861400</td>\n      <td>0.863368</td>\n      <td>0.613412</td>\n    </tr>\n    <tr>\n      <td>3</td>\n      <td>0.794900</td>\n      <td>0.845706</td>\n      <td>0.620186</td>\n    </tr>\n    <tr>\n      <td>4</td>\n      <td>0.739900</td>\n      <td>0.872625</td>\n      <td>0.622325</td>\n    </tr>\n    <tr>\n      <td>5</td>\n      <td>0.695000</td>\n      <td>0.888122</td>\n      <td>0.620962</td>\n    </tr>\n  </tbody>\n</table><p>"},"metadata":{}},{"execution_count":11,"output_type":"execute_result","data":{"text/plain":"TrainOutput(global_step=12275, training_loss=0.8117687913696537, metrics={'train_runtime': 4098.8402, 'train_samples_per_second': 383.232, 'train_steps_per_second': 2.995, 'total_flos': 264993044198400.0, 'train_loss': 0.8117687913696537, 'epoch': 5.0})"},"metadata":{}}]},{"cell_type":"markdown","source":["보시다시피 training loss는 잘 떨어지는 반면, validation loss는 중간부터 쭉 올라가는 것을 볼 수 있습니다.\n","Overfitting이 일어났다고 볼 수 있습니다.\n","\n","위와 같이 학습이 끝난 후 validation loss가 가장 낮은 모델을 가지고 test data의 성능을 평가하는 것은 다음과 같이 구현할 수 있습니다."],"metadata":{"id":"IuGFTHER_a_U"}},{"cell_type":"code","source":["# 모델 평가 (validation_matched 사용)\n","eval_dataset = dataset[\"validation_matched\"]\n","tokenized_eval_dataset = eval_dataset.map(preprocess_function, batched=True)\n","\n","eval_results = trainer.evaluate(eval_dataset=tokenized_eval_dataset)\n","print(\"Evaluation results on validation_matched:\")\n","print(eval_results)\n","print(f'{eval_results[\"eval_accuracy\"]:.2%}')\n","\n","# 성능이 50%를 넘는지 확인\n","if eval_results[\"eval_accuracy\"] > 0.5:\n","    print(\"성능이 50%를 넘었습니다!\")\n","else:\n","    print(\"성능이 50%를 넘지 못했습니다. 모델을 개선해야 합니다.\")\n","\n","# 모델 저장\n","trainer.save_model(\"./mnli_model\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":148,"referenced_widgets":["6fab1138a5be481ca7b0444ae4f9a1b9"]},"id":"16mRdiEgeVPQ","executionInfo":{"status":"ok","timestamp":1725797932943,"user_tz":-540,"elapsed":25436,"user":{"displayName":"조승혁","userId":"15759752471844115325"}},"outputId":"50422d77-9688-47e2-d59b-e7e5a0305602","execution":{"iopub.status.busy":"2024-10-08T13:08:12.167077Z","iopub.execute_input":"2024-10-08T13:08:12.167769Z","iopub.status.idle":"2024-10-08T13:08:32.010653Z","shell.execute_reply.started":"2024-10-08T13:08:12.16772Z","shell.execute_reply":"2024-10-08T13:08:32.009698Z"},"trusted":true},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":"Map:   0%|          | 0/9815 [00:00<?, ? examples/s]","application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6fab1138a5be481ca7b0444ae4f9a1b9"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"<IPython.core.display.HTML object>","text/html":"\n    <div>\n      \n      <progress value='77' max='77' style='width:300px; height:20px; vertical-align: middle;'></progress>\n      [77/77 00:15]\n    </div>\n    "},"metadata":{}},{"name":"stdout","text":"Evaluation results on validation_matched:\n{'eval_loss': 0.8252347111701965, 'eval_accuracy': 0.6357615894039735, 'eval_runtime': 15.9009, 'eval_samples_per_second': 617.26, 'eval_steps_per_second': 4.842, 'epoch': 5.0}\n63.58%\n성능이 50%를 넘었습니다!\n","output_type":"stream"}]},{"cell_type":"markdown","source":["이전에 학습 인자에서 `load_best_model_at_end=True`를 넘겨줬기 때문에 `trainer`는 학습이 끝난 후, 기본적으로 validation loss가 가장 좋은 모델을 가지고 `evaluate`를 진행합니다.\n","실제로 결과를 보면 `eval_loss`가 가장 낮은 validation loss와 유사한 것을 볼 수 있습니다.\n","\n","평가할 때 사용한 모델은 다음과 같이 저장할 수 있습니다."],"metadata":{"id":"h05cUK6N_te4"}},{"cell_type":"markdown","source":["그리고 저장한 모델을 가지고 다른 예시들을 예측하는 것은 다음과 같이 구현할 수 있습니다."],"metadata":{"id":"QUXpdaWu__v0"}},{"cell_type":"markdown","source":["HuggingFace의 `pipeline`은 다양한 모델들에 대하여 서비스에 사용할 수 있는 형태들을 제공합니다.\n","여기서는 영화 리뷰가 주어졌을 때, label이 0(부정적인 리뷰)인지 1(긍정적인 리뷰)인지 예측 결과를 보여줄 뿐만 아니라 그 신뢰도를 `score`로 넘겨주게 됩니다.\n","\n","이처럼 HuggingFace를 활용하면 모델이나 예측, 학습 코드를 구현할 필요 없이 인자로 설정값들만 넘겨주면 쉽게 구현 할 수 있습니다."],"metadata":{"id":"U_uPElGAAGwH"}}]}